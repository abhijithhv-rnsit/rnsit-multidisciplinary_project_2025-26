<!DOCTYPE html>
<html>
<head>
    <title>Admin Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-light">

<nav class="navbar navbar-dark" style="background:#003366">
    <div class="container-fluid">
        <span class="navbar-brand fw-bold">RNSIT Project Admin Dashboard</span>
        <a href="/admin" class="btn btn-outline-light btn-sm">Back to Admin</a>
    </div>
</nav>

<div class="container mt-4">

    <!-- SUMMARY CARDS -->
    <div class="row text-center mb-4">
        <div class="col-md-4">
            <div class="card shadow">
                <div class="card-body">
                    <h6>Total Teams</h6>
                    <h2>{{ total_teams }}</h2>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card shadow">
                <div class="card-body">
                    <h6>Total Problems</h6>
                    <h2>{{ total_problems }}</h2>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card shadow">
                <div class="card-body">
                    <h6>Departments</h6>
                    <h2>{{ dept_data|length }}</h2>
                </div>
            </div>
        </div>
    </div>

    <!-- CHARTS -->
    <div class="row">
        <div class="col-md-6 mb-4">
            <div class="card shadow">
                <div class="card-header">Teams per Department</div>
                <div class="card-body">
                    <canvas id="deptChart"></canvas>
                </div>
            </div>
        </div>

        <div class="col-md-6 mb-4">
            <div class="card shadow">
                <div class="card-header">Hardware vs Software</div>
                <div class="card-body">
                    <canvas id="typeChart"></canvas>
                </div>
            </div>
        </div>

        <div class="col-md-6 mb-4">
            <div class="card shadow">
                <div class="card-header">Difficulty Distribution</div>
                <div class="card-body">
                    <canvas id="diffChart"></canvas>
                </div>
            </div>
        </div>
    </div>

</div>

<script>
const deptLabels = {{ dept_data | map(attribute=0) | list | tojson }};
const deptValues = {{ dept_data | map(attribute=1) | list | tojson }};

new Chart(document.getElementById("deptChart"), {
    type: 'bar',
    data: {
        labels: deptLabels,
        datasets: [{
            label: 'Teams',
            data: deptValues
        }]
    }
});

const typeLabels = {{ type_data | map(attribute=0) | list | tojson }};
const typeValues = {{ type_data | map(attribute=1) | list | tojson }};

new Chart(document.getElementById("typeChart"), {
    type: 'pie',
    data: {
        labels: typeLabels,
        datasets: [{
            data: typeValues
        }]
    }
});

const diffLabels = {{ diff_data | map(attribute=0) | list | tojson }};
const diffValues = {{ diff_data | map(attribute=1) | list | tojson }};

new Chart(document.getElementById("diffChart"), {
    type: 'pie',
    data: {
        labels: diffLabels,
        datasets: [{
            data: diffValues
        }]
    }
});
</script>

</body>
</html>
